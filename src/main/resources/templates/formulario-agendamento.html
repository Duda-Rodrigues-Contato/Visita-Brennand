<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Agendamento de Visita</title>
    <link rel="icon" th:href="@{/img/1.png}" type="image/x-icon" />
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <script src="https://unpkg.com/imask"></script>
  </head>
  
  <body>
     <header class="header">
        <div class="header__container">
            <a href="/status-parque" class="brand">
                <img th:src="@{../img/1.png}" alt="Logo Gestão Viva" class="brand__logo" />
                <span>Gestão Viva</span>
            </a>
            <nav class="nav">
                <a th:href="@{/status-parque}" class="nav-link">Início</a>
                <a th:href="@{/agendamento}" class="nav-link active">Agendamento</a>
                <a th:href="@{/dashboard}" class="nav-link">Dashboard</a>
                <a th:href="@{/dashboard/avaliacoes}" class="nav-link">Avaliações</a>
                <a th:href="@{/check-in}" class="nav-link">Check-in</a>
        </div>
    </header>
    <div class="container">
      <h1>Pré-Cadastramento de Visita</h1>

      <div class="form-tabs">
        <button type="button" class="tab-link active" data-tab="grupo">
          Agendamento em Grupo
        </button>
        <button type="button" class="tab-link" data-tab="individual">
          Agendamento Individual
        </button>
      </div>

      <form
        th:action="@{/agendamento}"
        th:object="${visitaDTO}"
        method="post"
        id="formAgendamento"
        novalidate 
      >
        <div id="grupo-form-section" class="form-section">
          <fieldset>
            <legend>1. Informações da Instituição</legend>
            <label for="nomeInstituicao">Nome da Instituição *</label>
            <input
              type="text"
              id="nomeInstituicao"
              th:field="*{nomeInstituicao}"
              placeholder="Ex: Colégio Exemplo"
            />
            <small class="error-message" id="nomeInstituicao-error"></small>
            <small
              class="error-message"
              th:if="${#fields.hasErrors('nomeInstituicao')}"
              th:errors="*{nomeInstituicao}"
            ></small>
            
            <label for="cnpj">CNPJ (Opcional)</label>
            <input
              type="text"
              id="cnpj"
              th:field="*{cnpj}"
              placeholder="00.000.000/0000-00"
            />
            <small class="error-message" id="cnpj-error"></small>

            <label for="tipoInstituicao">Tipo de Instituição *</label>
            <select id="tipoInstituicao" th:field="*{tipoInstituicao}">
              <option value="" disabled selected>Selecione o tipo</option>
              <option value="ESCOLA_PUBLICA">Escola Pública</option>
              <option value="ESCOLA_PRIVADA">Escola Privada</option>
              <option value="UNIVERSIDADE">Universidade</option>
              <option value="EMPRESA">Empresa</option>
              <option value="OUTRO">Outro</option>
            </select>
            <small class="error-message" id="tipoInstituicao-error"></small>
            <small
              class="error-message"
              th:if="${#fields.hasErrors('tipoInstituicao')}"
              th:errors="*{tipoInstituicao}"
            ></small>
          </fieldset>
        </div>

        <div id="individual-form-section" class="form-section hidden">
            <fieldset>
                <legend>1. Suas Informações Pessoais</legend>
                 <label for="cnpjInd">CPF (Opcional)</label>
                <input type="text" id="cnpjInd" th:field="*{cnpj}" placeholder="000.000.000-00" />
                <small class="error-message" id="cnpjInd-error"></small>
                
                <label for="dataNascimento">Data de Nascimento</label>
                <input type="date" id="dataNascimento" th:field="*{dataNascimento}" />
                <label for="sexo">Gênero</label>
                <select id="sexo" th:field="*{sexo}">
                  <option value="PREFIRO_NAO_INFORMAR">Prefiro não informar</option>
                  <option value="FEMININO">Feminino</option>
                  <option value="MASCULINO">Masculino</option>
                  <option value="NAO_BINARIO">Não-binário</option>
                  <option value="OUTRO">Outro</option>
                </select>
            </fieldset>
        </div>

        <fieldset>
            <legend id="responsavel-legend">2. Informações do Responsável</legend>
            <label for="nomeResponsavel">Nome Completo *</label>
            <input
              type="text"
              id="nomeResponsavel"
              th:field="*{nomeResponsavel}"
              placeholder="Seu nome completo"
            />
            <small class="error-message" id="nomeResponsavel-error"></small>
            <small
              class="error-message"
              th:if="${#fields.hasErrors('nomeResponsavel')}"
              th:errors="*{nomeResponsavel}"
            ></small>
            
            <label for="emailResponsavel">E-mail de Contato *</label>
            <input
              type="email"
              id="emailResponsavel"
              th:field="*{emailResponsavel}"
              placeholder="seu.email@exemplo.com"
            />
            <small class="error-message" id="emailResponsavel-error"></small>
            <small
              class="error-message"
              th:if="${#fields.hasErrors('emailResponsavel')}"
              th:errors="*{emailResponsavel}"
            ></small>
            
            <label for="telefoneResponsavel">Telefone de Contato (WhatsApp) *</label>
            <input
              type="tel"
              id="telefoneResponsavel"
              th:field="*{telefoneResponsavel}"
              placeholder="00 00000-0000"
            />
            <small class="error-message" id="telefoneResponsavel-error"></small>
            <small
              class="error-message"
              th:if="${#fields.hasErrors('telefoneResponsavel')}"
              th:errors="*{telefoneResponsavel}"
            ></small>
        </fieldset>
        
        <div id="membros-section" class="form-section">
            <fieldset>
              <legend>3. Adicionar Membros do Grupo</legend>
              <label for="nomeMembro"
                >Adicione os nomes dos membros do grupo</label
              >
              <div class="membro-input-group">
                <input
                  type="text"
                  id="nomeMembro"
                  placeholder="Ex: João da Silva"
                />
                <button type="button" id="btnAddMembro">Adicionar Membro</button>
              </div>

              <div id="listaMembrosContainer">
                <h4>
                  Membros Adicionados: <span id="contadorMembros">(0)</span>
                </h4>
                <ul id="listaMembros"></ul>
              </div>

              <div id="membrosHiddenContainer"></div>
            </fieldset>
        </div>

        <fieldset>
          <legend id="detalhes-legend">4. Detalhes da Visita</legend>
          <label for="origemVisitante">De onde você é? (Cidade/Estado) *</label>
          <input type="text" th:field="*{origemVisitante}" id="origemVisitante" />
          <small class="error-message" id="origemVisitante-error"></small>
          <small
            class="error-message"
            th:if="${#fields.hasErrors('origemVisitante')}"
            th:errors="*{origemVisitante}"
          ></small>
          
          <label for="dataVisita">Data da Visita *</label>
          <input
            type="date"
            id="dataVisita"
            th:field="*{dataVisita}"
          />
          <small
            class="error-message"
            th:if="${#fields.hasErrors('dataVisita')}"
            th:errors="*{dataVisita}"
          ></small>
          <small id="date-error" class="error-message"></small>
          
          <label for="horarioChegada">Horário de Chegada Previsto *</label>
          <select id="horarioChegada" th:field="*{horarioChegada}">
            <option value="" disabled selected>
              Selecione primeiro a data
            </option>
          </select>
          <small class="error-message" id="horarioChegada-error"></small>
          <small
            class="error-message"
            th:if="${#fields.hasErrors('horarioChegada')}"
            th:errors="*{horarioChegada}"
          ></small>
          
          <div class="checkbox-group" id="pcd-group-section">
            <input type="checkbox" id="incluiPcd" th:field="*{incluiPcd}" />
            <label for="incluiPcd"
              >A visita inclui pessoas com deficiência (PCD) ou mobilidade
              reduzida.</label
            >
          </div>
        </fieldset>

        <input
          type="hidden"
          id="numeroVisitantes"
          th:field="*{numeroVisitantes}"
        />

        <div class="form-actions">
          <button type="submit" class="submit-btn">AGENDAR VISITA</button>
          <a th:href="@{/status-parque}" class="cancel-btn">CANCELAR</a>
        </div>
      </form>
    </div>
    <script th:src="@{/js/script.js}"></script>
  </body>
</html>